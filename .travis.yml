language: csharp
solution: src/kOS.sln
sudo: false

addons:
  apt:
    packages:
    - python-sphinx

# Pre-shared token for pushing notifications to slack chat
notifications:
  slack: ksp-kos:51DTQ4ZBP9SlGNnLWJ5D84vp

install: pip install sphinx_rtd_theme

# Before the install the library dlls need to be downloaded
before_script:
- chmod +x travis-before.sh && ./travis-before.sh

# Cleanup the downloaded resources
after_script:
- chmod +x travis-after.sh && ./travis-after.sh

before_deploy:
- mkdir src/kOS/bin/dist 
- tar -zcvf src/kOS/bin/dist/build_$TRAVIS_BUILD_NUMBER.tgz src/kOS/bin/Release/kOS*.dll

deploy:
  provider: s3
  access_key_id: "AKIAINHSGTBU5O3DKV2Q"
  secret_access_key: "$S3_DEPLOY_SECRET"
  bucket: "kos-artifacts"
  skip_cleanup: true
  local_dir: "src/kOS/bin/dist/"
